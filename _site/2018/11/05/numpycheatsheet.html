<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Awesome Numpy Tutorial</title>
  </head>
  <body>
    <nav>
  
    <a href="/" >
      Home
    </a>
  
    <a href="/python" >
      Python
    </a>
  
</nav>

    <small>5 November 2018</small>
<h1>Awesome Numpy Tutorial</h1>

<p class="view">by </p>

<h2 id="numpy">Numpy</h2>

<p>We discuss following features of numpy</p>

<ul>
  <li>ndarray (N dimensional Array)</li>
  <li>Indexing and Slicing</li>
  <li>Vectorization</li>
  <li>Broadcasting</li>
  <li>Important Numpy Operations(functions) in ML/DL Algorithms</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
</code></pre></div></div>

<h3 id="ndarray">ndarray</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># create ndarray from a list 
</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="n">nd_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>

<span class="c1"># shape
</span><span class="k">print</span> <span class="s">'shape : </span><span class="se">\n</span><span class="s">'</span><span class="p">,</span><span class="n">nd_array</span><span class="o">.</span><span class="n">shape</span>

<span class="c1"># size = # of elements
</span>
<span class="k">print</span> <span class="s">'size : </span><span class="se">\n</span><span class="s">'</span><span class="p">,</span><span class="n">nd_array</span><span class="o">.</span><span class="n">size</span>

<span class="c1">#array from tuples
</span>
<span class="n">tup</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">tup_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span>
<span class="k">print</span> <span class="s">'Tuple array  :</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span><span class="n">tup_array</span>

<span class="c1">#Number of dimensions
</span><span class="k">print</span> <span class="s">"Number of Dimensions :</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">nd_array</span><span class="o">.</span><span class="n">ndim</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shape : 
(2, 3)
size : 
6
Tuple array  :
[[1 2 3]
 [4 5 6]]
Number of Dimensions :
2
</code></pre></div></div>

<h3 id="indexing-and-slicing">Indexing and Slicing</h3>

<ul>
  <li>Slicing returns view of original array. Changing elements in Slice will affect Original Array.</li>
  <li>copy() function duplicates the array.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># arange gives array sequence and reshape converts this sequence into ndarray
</span><span class="k">print</span> <span class="s">'Shape of X : </span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>

<span class="c1">#access particular element in ith row and jth column
</span><span class="n">X_ij</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="k">print</span> <span class="n">X_ij</span>

<span class="c1"># acess all elements in a row
</span><span class="n">X_i</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">4</span><span class="p">,:]</span>
<span class="k">print</span> <span class="s">"Elements in 4 th row </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">X_i</span>

<span class="c1"># access all elements in a column
</span><span class="n">X_j</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
<span class="k">print</span> <span class="s">"Elements in 5 th column </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">X_j</span>

<span class="c1"># Access last element in 0th row
</span><span class="n">last</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span> <span class="s">"Last element in 0 th row </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">last</span>


<span class="c1">#Indexing with Boolean array ; this kind of indexing is used more in Pandas DataFrames.
</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"Elements in Y : </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">Y</span>
<span class="n">less_Y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">&lt;</span><span class="mi">10</span>
<span class="k">print</span> <span class="s">"Boolean array </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">less_Y</span>
<span class="k">print</span> <span class="s">"Elements less than 10 in Y: </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">Y</span><span class="p">[</span><span class="n">less_Y</span><span class="p">]</span>


<span class="c1"># Indexing with a list. This is useful if you want to shuffle your data
</span><span class="n">data</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="mi">3</span><span class="p">,:]</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">shuf_Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"Data before shuffle : </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">data</span>
<span class="k">print</span> <span class="s">"Shuffled index </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">index</span>
<span class="k">print</span> <span class="s">"Shuffled data : </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Shape of X : 
(25, 10)
45
Elements in 4 th row 
[40 41 42 43 44 45 46 47 48 49]
Elements in 5 th column 
[  5  15  25  35  45  55  65  75  85  95 105 115 125 135 145 155 165 175
 185 195 205 215 225 235 245]
Last element in 0 th row 
9
Elements in Y : 
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14]
Boolean array 
[ True  True  True  True  True  True  True  True  True  True False False
 False False False]
Elements less than 10 in Y: 
[0 1 2 3 4 5 6 7 8 9]
Data before shuffle : 
[[ 0  1  2  3  4  5  6  7  8  9]
 [10 11 12 13 14 15 16 17 18 19]
 [20 21 22 23 24 25 26 27 28 29]]
Shuffled index 
[2 1 0]
Shuffled data : 
[[20 21 22 23 24 25 26 27 28 29]
 [10 11 12 13 14 15 16 17 18 19]
 [ 0  1  2  3  4  5  6  7  8  9]]
</code></pre></div></div>

<h3 id="vectorization">Vectorization</h3>

<ul>
  <li>Vectorization makes code more pythonic and efficient.</li>
  <li>Try to use vectorization where ever possible in ML Algos.</li>
  <li>Math expressions can be implemented with ease.</li>
  <li>No explicit looping, which makes concise code with less bugs.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#X,Y are two lists with 500 elements.
</span><span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
<span class="k">print</span> <span class="s">"Length of X :</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
<span class="k">print</span> <span class="s">"Length of Y :</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

<span class="n">X_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Y_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="k">print</span> <span class="s">'Shape of X_arr </span><span class="se">\n</span><span class="s">'</span><span class="p">,</span><span class="n">X_arr</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="s">'Shape of Y_arr </span><span class="se">\n</span><span class="s">'</span><span class="p">,</span><span class="n">Y_arr</span><span class="o">.</span><span class="n">shape</span>

</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Length of X :
500
Length of Y :
500
Shape of X_arr 
(500,)
Shape of Y_arr 
(500,)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%%</span><span class="n">timeit</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1</span> <span class="o">-</span><span class="n">r</span> <span class="mi">1</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">Y</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
        
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 loop, best of 1: 50.7 ms per loop
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%%</span><span class="n">timeit</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1</span> <span class="o">-</span><span class="n">r</span> <span class="mi">1</span>
<span class="n">result</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">X_arr</span><span class="p">,</span> <span class="n">Y_arr</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 loop, best of 1: 26.9 µs per loop
</code></pre></div></div>

<h3 id="broad-casting">Broad Casting</h3>

<ul>
  <li>numpy uses broadcasting while performing any operations on two arrays.</li>
  <li>It broadcasts smaller array to larger array so that they both are compatible.</li>
</ul>

<p>Two dimensions are equal iff</p>

<ul>
  <li>Both are equal (or)</li>
  <li>One of them is 1</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>

</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#both have same effect, later one uses broadcasting.
</span><span class="n">result</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span>
<span class="n">result1</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="mi">2</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># adding constant to array. This is used in ML algos, where bias is added to weight, data inner product
</span><span class="k">print</span> <span class="s">"Before adding a constant </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">a</span>
<span class="n">const_sum</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">5</span>
<span class="k">print</span> <span class="s">"After Constatn addition </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">const_sum</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"A : Before adding a constant </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">A</span>
<span class="n">const_sum</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="mi">5</span>
<span class="k">print</span> <span class="s">"A : After adding constant </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">const_sum</span>

<span class="c1"># broadcast constants columnwise
</span><span class="k">print</span> <span class="s">'Shape of A </span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
<span class="n">bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="k">print</span> <span class="s">'Shape of bias </span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">bias</span><span class="o">.</span><span class="n">shape</span>
<span class="n">const_sum</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">bias</span><span class="o">.</span><span class="n">T</span>
<span class="k">print</span> <span class="s">'Sum of A, bias </span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">const_sum</span>

<span class="c1"># broadcast constants rowwise
</span><span class="n">bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span> <span class="s">'Shape of bias'</span><span class="p">,</span><span class="n">bias</span><span class="o">.</span><span class="n">shape</span>
<span class="n">const_sum</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">bias</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span> <span class="s">'Sum of A, bias </span><span class="se">\n</span><span class="s"> '</span><span class="p">,</span> <span class="n">const_sum</span>

</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Before adding a constant 
[1 2 3]
After Constatn addition 
[6 7 8]
A : Before adding a constant 
[[0 1]
 [2 3]
 [4 5]]
A : After adding constant 
[[ 5  6]
 [ 7  8]
 [ 9 10]]
Shape of A 
(3, 2)
Shape of bias 
(2,)
Sum of A, bias 
[[ 3  6]
 [ 5  8]
 [ 7 10]]
Shape of bias (3, 1)
Sum of A, bias 
  [[ 3  4]
 [ 7  8]
 [11 12]]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># broad cast on different axes
</span><span class="kn">import</span> <span class="nn">random</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">xrange</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="mi">4</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="k">print</span> <span class="s">"Shape of Image :</span><span class="se">\n</span><span class="s"> "</span><span class="p">,</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="s">"Shape of Scale : </span><span class="se">\n</span><span class="s"> "</span><span class="p">,</span><span class="n">scale</span><span class="o">.</span><span class="n">shape</span>

<span class="k">print</span> <span class="s">"Image  : </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">image</span>
<span class="k">print</span> <span class="s">"Scale  :  </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">scale</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="n">scale</span><span class="p">)</span>

<span class="k">print</span> <span class="s">"Result after Scaling across different axes : </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">result</span>

</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shape of Image :
  (4, 4, 3)
Shape of scale : 
  (1, 1, 3)
Image  : 
[[[12 29 46]
  [38 13 39]
  [45 16  2]
  [18 24 23]]

 [[31  1 43]
  [30  9 33]
  [21  5 10]
  [19 32 40]]

 [[44 25 37]
  [15 28  8]
  [27 48 14]
  [47 36  4]]

 [[ 3 20 42]
  [ 0 26 49]
  [35  6  7]
  [34 17 41]]]
Scale  :  
[[[2 3 4]]]
Result after Scaling across different axes : 
[[[ 24  87 184]
  [ 76  39 156]
  [ 90  48   8]
  [ 36  72  92]]

 [[ 62   3 172]
  [ 60  27 132]
  [ 42  15  40]
  [ 38  96 160]]

 [[ 88  75 148]
  [ 30  84  32]
  [ 54 144  56]
  [ 94 108  16]]

 [[  6  60 168]
  [  0  78 196]
  [ 70  18  28]
  [ 68  51 164]]]
</code></pre></div></div>

<h3 id="important-matrix-operations">Important Matrix Operations</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Lets define two matrics 
</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="k">print</span> <span class="s">'Matrix A : </span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">A</span>
<span class="k">print</span> <span class="s">"Matrix B : </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">B</span>

<span class="c1"># Transpose of A
</span><span class="n">A_T</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span>
<span class="k">print</span> <span class="s">"Shape of A : </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="s">"Shape of A_T: </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">A_T</span><span class="o">.</span><span class="n">shape</span>

<span class="c1"># Matrix Addition
</span><span class="n">A_plus_B</span> <span class="o">=</span> <span class="n">A_T</span> <span class="o">+</span> <span class="n">B</span>


<span class="c1"># Matrix Subtraction
</span><span class="n">A_minus_B</span> <span class="o">=</span> <span class="n">A_T</span> <span class="o">-</span> <span class="n">B</span>


<span class="c1"># Multply matrix with constant
</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">alpha_mul_B</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">B</span>

<span class="c1"># Divide matrix with constant
</span>
<span class="n">alpha_div_B</span> <span class="o">=</span> <span class="n">B</span><span class="o">/</span><span class="n">alpha</span>

<span class="c1"># Inverse of Matrix
</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">C_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>


<span class="c1"># Sum elements w.r.t axis.
</span>
<span class="n">column_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># columwise sum
</span><span class="n">row_sum</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># rowwise sum
</span><span class="k">print</span> <span class="s">"Matrix Shape : </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">B</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="s">"Column Sum shape: </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">column_sum</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="s">"Row sum shape: </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">row_sum</span><span class="o">.</span><span class="n">shape</span>


<span class="c1"># Elementwise multiplicaiton 
</span><span class="n">ele_mul</span> <span class="o">=</span> <span class="n">A_T</span> <span class="o">*</span> <span class="n">B</span> 

<span class="c1"># Dot product 
</span><span class="n">dot_prod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>  <span class="c1"># In python &gt; 3.5 we can use @ for dot product
</span>





</code></pre></div></div>



  <small>tags: <em></em></small>


  </body>
</html>
